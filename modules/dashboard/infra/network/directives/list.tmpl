<section ng-controller="infraNetworkCtrl">
	<div class="w-100 c-both">
		<div class="f-left w20">
			<a class="btn btn-sm btn-primary" ng-if="access.addNetwork" ng-click="addNetwork()">
				<span class="icon icon-plus"></span> Add New Network
			</a>
		</div>
		
		<div class="f-right w30">
			<div class="searchBoxContainer">
				<button class="btn btn-success f-right" ng-click="listNetworks(selectedGroup)">
					Refresh&nbsp;&nbsp;<span class="icon icon-loop2"></span>
				</button>
			</div>

			<div ng-if="infraGroups.length > 0">
				Group:
				<select style="display:inline" class="form-control w50" ng-model="selectedGroup" ng-change="listNetworks(selectedGroup)" ng-options="group as group.name group by group.region for group in infraGroups">
				</select>
			</div>
		</div>
		<br /><br />
	</div>
	
	<div ng-if="access.list">
		<alert type="warning" ng-if="!infraNetworks || infraNetworks.length === 0">
			No Networks found in this Group.
		</alert>
		<div ng-if="infraNetworks && infraNetworks.length > 0" class="entryBoxes">
			<br />
			
			<accordion close-others="false">
				<accordion-group ng-repeat="oneNetwork in infraNetworks">
					<accordion-heading>
						{{oneNetwork.name}}
					</accordion-heading>
					<div class="w-100 c-both t-right">
						<a href="" ng-click="editNetwork(oneNetwork)" class="btn btn-sm btn-primary">
							<span class="icon icon-pencil2"></span>&nbsp;Modify
						</a>&nbsp;&nbsp;
						<a class="btn btn-sm btn-danger" href="" ng-click="deleteNetwork(oneNetwork)" ng-confirm-click="Are you sure you want to delete this network ?">
							<span class="icon icon-cross"></span>&nbsp;Delete
						</a>
					</div>
					<fieldset>
						<legend>Addresses</legend>
						<div class="entryBoxes entryBoxesGrid">
							<div ng-repeat="oneAddress in oneNetwork.addressPrefixes">
								<div class="entryBox blueBox" style="padding: 3px 5px;">
									<b>Network Ranger</b>&nbsp;{{oneAddress}}
								</div>
							</div>
						</div>
					</fieldset>
					
					<fieldset ng-if="oneNetwork.dnsServers && oneNetwork.dnsServers.length > 0">
						<legend>DNS Servers</legend>
						<div class="entryBoxes entryBoxesGrid">
							<div ng-repeat="oneServer in oneNetwork.dnsServers">
								<div class="entryBox blueBox" style="padding: 3px 5px;">
									<b>IP Address</b>&nbsp;{{oneServer}}
								</div>
							</div>
						</div>
					</fieldset>
					
					<fieldset ng-if="oneNetwork.subnets && oneNetwork.subnets.length > 0">
						<legend>Subnets</legend>
						<div class="grid">
							<table width="100%">
								<thead>
									<tr>
										<th>Name</th>
										<th>Address</th>
									</tr>
								</thead>
								<tbody>
									<tr ng-repeat="oneSubnet in oneNetwork.subnets" ng-class-even="'even'" ng-class-odd="'odd'">
										<td>{{oneSubnet.name}}</td>
										<td>{{oneSubnet.addressPrefix}}</td>
									</tr>
								</tbody>
							</table>
						</div>
					</fieldset>
					
					<fieldset>
						<legend>Firewall Rules</legend>
						<div class="grid">
							<table width="100%">
								<thead>
									<tr>
										<th>Priority</th>
										<th>Name</th>
										<th>Protocol</th>
										<th>Port</th>
										<th>Source Range</th>
										<th>Direction</th>
										<th>Access</th>
										<th>Published</th>
									</tr>
								</thead>
								<tbody>
									<tr ng-repeat="onePort in oneNetwork.firewall.ports" ng-class-even="'even'" ng-class-odd="'odd'" tooltip="{{onePort.description}}">
										<td>{{onePort.priority}}</td>
										<td>{{onePort.name}}</td>
										<td>{{onePort.protocol}}</td>
										<td>{{onePort.published}}</td>
										<td>{{(onePort.target === '*') ? "All Interfaces" : onePort.target }}</td>
										<td>{{onePort.direction}}</td>
										<td>{{onePort.access}}</td>
										<td>{{(onePort.isPublished) ? "YES" : "NO"}}</td>
									</tr>
								</tbody>
							</table>
						</div>
					</fieldset>
				</accordion-group>
			</accordion>
		</div>
	</div>
</section>
